{
  "control_id": "adop_status",
  "version": "1.1",
  "title": "ADOP Patch Application Status",
  "description": "Monitors the status of ADOP (AutoPatch) sessions and patch application progress. Helps track ongoing patches and identify stuck or failed patching operations.",
  "intent": "adop",
  "safety_classification": "SAFE_READONLY",
  "keywords": {
    "en": [
      "adop",
      "adop status",
      "autopatch",
      "patch",
      "patch status",
      "patch application",
      "patch session",
      "apply patch",
      "deployment",
      "adop progress",
      "adop session",
      "patch cycle",
      "adop running",
      "adop pending",
      "ad session",
      "patching status",
      "maintenance",
      "patch management"
    ],
    "tr": [
      "adop",
      "adop durumu",
      "autopatch",
      "yama",
      "yama durumu",
      "yama uygulaması",
      "yama oturumu",
      "yama uygulanıyor",
      "dağıtım",
      "adop ilerleme",
      "adop oturumu",
      "yama döngüsü",
      "adop çalışıyor",
      "adop beklemede",
      "yamalar",
      "yama yönetimi",
      "bakım",
      "patch",
      "uygulama"
    ]
  },
  "queries": [
    {
      "query_id": "adop_sessions_summary",
      "timeout_seconds": 30,
      "row_limit": 20,
      "sql": "SELECT node_name, node_type, NVL(DECODE(prepare_status, 'Y', 'Done', 'N', 'Not done', 'X', 'N/A', 'R', 'Running', 'F', 'Failed', prepare_status), 'N/A') AS prepare, NVL(DECODE(apply_status, 'Y', 'Done', 'N', 'Not done', 'P', 'Partial', 'X', 'N/A', 'R', 'Running', 'F', 'Failed', apply_status), 'N/A') AS apply, NVL(DECODE(finalize_status, 'Y', 'Done', 'N', 'Not done', 'X', 'N/A', 'R', 'Running', 'F', 'Failed', finalize_status), 'N/A') AS finalize, NVL(CASE cutover_status WHEN 'Y' THEN 'Done' WHEN 'N' THEN 'Not done' WHEN 'X' THEN 'N/A' WHEN '0' THEN 'Started' WHEN '1' THEN 'Force shutdown done' WHEN '3' THEN 'DB cutover done' WHEN '4' THEN 'FS cutover done' WHEN '6' THEN 'Force startup done' ELSE cutover_status END, 'N/A') AS cutover, NVL(DECODE(cleanup_status, 'Y', 'Done', 'N', 'Not done', 'X', 'N/A', 'R', 'Running', 'F', 'Failed', cleanup_status), 'N/A') AS cleanup, NVL(DECODE(abort_status, 'Y', 'Done', 'N', 'Not done', 'X', 'N/A', 'R', 'Running', 'F', 'Failed', abort_status), 'N/A') AS abort, NVL(DECODE(status, 'C', 'Completed', 'R', 'Running', 'F', 'Failed', status), 'N/A') AS overall_status FROM apps.ad_adop_sessions WHERE adop_session_id = (SELECT MAX(adop_session_id) FROM apps.ad_adop_sessions WHERE node_type = 'master' AND prepare_status <> 'X') ORDER BY node_type, node_name asc",
      "binds": [],
      "result_schema": [
        {
          "name": "adop_session_id",
          "type": "NUMBER",
          "sensitive": false
        },
        {
          "name": "session_status",
          "type": "VARCHAR2",
          "sensitive": false
        },
        {
          "name": "active_cycles",
          "type": "NUMBER",
          "sensitive": false
        },
        {
          "name": "earliest_session",
          "type": "DATE",
          "sensitive": false
        },
        {
          "name": "last_update",
          "type": "DATE",
          "sensitive": false
        }
      ]
    },
    {
      "query_id": "adop_cycle_details",
      "timeout_seconds": 30,
      "row_limit": 30,
      "sql": "SELECT 'ADOP' as cycle_type, SYSDATE as check_date, COUNT(*) as patch_count FROM fnd_patches WHERE status = 'A' OR status = 'E' GROUP BY SYSDATE",
      "binds": [],
      "result_schema": [
        {
          "name": "cycle_type",
          "type": "VARCHAR2",
          "sensitive": false
        },
        {
          "name": "check_date",
          "type": "DATE",
          "sensitive": false
        },
        {
          "name": "patch_count",
          "type": "NUMBER",
          "sensitive": false
        }
      ]
    }
  ],
  "doc_hint": "Look for: ADOP sessions (should be 0 or 1 active), session status (RUNNING = active patching, COMPLETED = finished), cycle status, failed patches (red flag). Alert on: Multiple active sessions, FAILED status, patches with errors, sessions stuck >24 hours.",
  "analysis_prompt": "Analyze ADOP patch application status in EBS. Summarize: 1) Active/pending ADOP sessions, 2) Patch cycles and progress (total/applied/failed), 3) Any failed patches or errors, 4) Overall health and recommended next steps. Status: OK (no active/completed recent) / WARN (active sessions) / CRIT (failed patches)."
}