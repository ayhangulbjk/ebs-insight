{
  "control_id": "active_users",
  "version": "1.0.0",
  "title": "Active Connected Users / Aktif Bağlı Kullanıcılar",
  "description": "Lists all currently connected users to the EBS database with session details and activity status",
  "intent": "performance",
  "keywords": {
    "en": ["user", "active user", "connected user", "session", "who is connected", "current users", "online users"],
    "tr": ["kullanıcı", "aktif kullanıcı", "bağlı kullanıcı", "oturum", "kim bağlı", "şu anki kullanıcılar", "çevrimiçi kullanıcılar"]
  },
  "queries": [
    {
      "query_id": "q_active_users_v1",
      "sql": "SELECT SID, SERIAL#, USERNAME, OSUSER, MACHINE, PROGRAM, LOGON_TIME, STATUS FROM V$SESSION WHERE USERNAME IS NOT NULL AND STATUS = 'ACTIVE' ORDER BY LOGON_TIME DESC",
      "binds": {},
      "row_limit": 100,
      "timeout_seconds": 30,
      "result_schema": [
        {"name": "SID", "type": "NUMBER", "sensitive": false},
        {"name": "SERIAL#", "type": "NUMBER", "sensitive": false},
        {"name": "USERNAME", "type": "VARCHAR2", "sensitive": true},
        {"name": "OSUSER", "type": "VARCHAR2", "sensitive": true},
        {"name": "MACHINE", "type": "VARCHAR2", "sensitive": false},
        {"name": "PROGRAM", "type": "VARCHAR2", "sensitive": false},
        {"name": "LOGON_TIME", "type": "DATE", "sensitive": false},
        {"name": "STATUS", "type": "VARCHAR2", "sensitive": false}
      ]
    }
  ],
  "safety_classification": "SENSITIVE",
  "doc_hint": "Look for unexpected users, inactive sessions, or suspicious programs. High count of ACTIVE sessions may indicate load or runaway jobs.",
  "analysis_prompt": "Analyze the active user sessions. Count by program/machine. Flag any unusual activity or unexpected connections. Recommend next steps if threshold exceeded."
}
